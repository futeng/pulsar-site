---
title: "What’s New in Apache Pulsar 2.10.3"
date: 2023-01-09
author: "liangyepianzhou, momo-jun"
---

Apache Pulsar 社区发布了 2.10.3 版本！50 位贡献者提供了改进和错误修复，共提交了 155 个代码变更。感谢所有贡献者的付出。

这篇博客介绍了最值得注意的变更。如需完整的变更列表，包括所有功能增强和错误修复，请查看 [Pulsar 2.10.3 发布说明](https://pulsar.apache.org/release-notes/versioned/pulsar-2.10.3/)。

<!--truncate-->

### 在客户端 API 的事务中添加 `getState` ([PR-17423](https://github.com/apache/pulsar/pull/17423))

#### 问题描述
在早期版本中，无法使用客户端 API 获取客户端事务的状态。用户在结束事务之前无法检查事务的状态。

#### 解决方案
添加了一个接口来获取事务的状态。

### 启用延迟事务消息 ([PR-17548](https://github.com/apache/pulsar/pull/17548))

#### 问题描述
在早期版本中，延迟消息传递和事务消息不能同时使用。当发送带有特定延迟的事务消息并提交此事务时，事务发送的消息会立即被消费者接收，没有任何预期的延迟。

#### 解决方案
允许客户端使用 `trackDelayedDelivery` 通过事务发送延迟消息。

### 允许配置和禁用用于检测消息中固定延迟的 `lookahead` 大小 ([PR-17907](https://github.com/apache/pulsar/pull/17907))

#### 问题描述
当检测到所有消息都有固定的延迟时间时，用户能够配置 `lookahead` 的大小来检测并暂停从游标读取会很有帮助。但在早期版本中，`lookahead` 的大小是预定义和固定的，缺乏灵活性并限制了使用。

#### 解决方案
允许配置和禁用用于检测消息中固定延迟的 `lookahead` 大小。

### 修复卸载 ledger 时的内存泄漏问题 ([PR-18500](https://github.com/apache/pulsar/pull/18500))

#### 问题描述
在早期版本中，`BlockAwareSegmentInputStreamImpl` 在 `close` 方法中从不释放 BookKeeper 条目，导致频繁运行卸载活动的 broker 上出现 `OutOfDirectMemory` 错误。此 PR 修复了错误的 `if` 条件。

### 修复命名空间无法强制删除的问题 ([PR-18307](https://github.com/apache/pulsar/pull/18307))

#### 问题描述
在早期版本中，当您强制删除命名空间时，如果 `__transaction_buffer_snapshot` 和 `__change_events`（用于 Topic 策略的系统 Topic）已被删除，那么常规 Topic 的删除将失败，因为它无法清除快照和 Topic 策略。

#### 解决方案
删除命名空间时，在删除系统 Topic 之前删除常规 Topic。并且删除系统 Topic `__change_events` 不会清除其 Topic 策略。

# 接下来是什么？

如果您有兴趣了解更多关于 Pulsar 2.10.3 的信息，现在就可以[下载](https://pulsar.apache.org/download/)并试用！

有关 Apache Pulsar 项目和当前进展的更多信息，请访问 [Pulsar 网站](https://pulsar.apache.org)，在 Twitter 上关注项目 [@apache_pulsar](https://twitter.com/apache_pulsar)，并加入 [Pulsar Slack](https://apache-pulsar.slack.com/)！